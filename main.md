---
title: Система работы с документами Pandoc
author:
- Михаил Беляев
date: \today
---

# 

- Систем работы с документами существует целая куча
- Очевидной кажется идея свести их все в одну

# Enter Pandoc

- Pandoc --- это универсальный конвертер документов
- "Швейцарский нож" работы с документами

\begin{center}
\vfill
\includegraphics[height=0.7\textheight]{PandocOverview.drawio}
\end{center}

# Pandoc Markdown

- Pandoc поддерживает много разных языков на входе
    - Даже tex и docx!
- Но основной язык -- это особенная разновидность markdown


# Pandoc Markdown: пример

`````md
## Borealis contracts

- A comment-based *language* based on **ACSL**

```C
// @requires a > 0
void foo(int a) {...}
```

- Supports stateful contracts using custom properties
- The whole standard library is annotated!
`````

# Pandoc Markdown: необычный язык разметки

- Поддерживает математику из \LaTeX из коробки
- Куча расширений
- Подсветка синтаксиса
- Цитаты и библиография
- Можно навешивать свои атрибуты почти на что угодно

# Pandoc Markdown: презентации

- Можно делать презентации!
    - И экспортировать их в slidy, s5, Powerpoint или Latex
- Синтаксис тот же самый, но есть пара доп. команд

- **Эта презентация сделана в Pandoc**

# Насколько это применимо в реальности

- Хотите увидеть **по-настоящему** сложный документ в формате Pandoc -- откройте спецификацию Kotlin
- Или спецификацию Scala

# Pandoc: расширяемость

- Всё вышеизложенное -- ерунда

. . . 

- Настоящая *фишка* Pandoc -- это его кастомизируемость

# Pandoc: расширяемость

- Хотите генерировать документы не под стандартный шаблон -- пожалуйста
    - Все шаблоны для текстовых форматов легко редактируются
- Хотите добавить своих команд и использовать их -- легко
    - Поддерживаются макросы а-ля \LaTeX, но во всех доступных форматах
- Хотите кастомный заголовок/хвостовик в конкретном формате -- есть для этого аргументы
- Хотите сделать что-то ну совсем безумное?
    - ...

# Pandoc: фильтры

- Фильтр -- это программа, которая берёт на вход документ, что-то с ним делает и выдаёт его на выход
- Из коробки поддерживаются Haskell, Python и Lua
- Фильтров может быть сколько угодно на один запуск

# Pandoc: что может сделать фильтр?

- Фильтр получает на вход документ в виде JSON
- Выдаёт его же в виде того же JSON

- В рамках этих ограничений фильтр может делать **всё**

Примеры из жизни:

- Вместо кода на каком-то языке скомпилировать его, запустить и вставить результат
- Вместо ascii-арта с картинкой отрендерить и вставить в документ саму картинку
- Взять сырые данные и сделать из них красивую табличку
- Особым образом обработать все заголовки

# Pandoc: что может сделать фильтр?

Примеры из production спецификации Котлина:

- Детекция битых ссылок
- Преобразование грамматики и вставка её в документ
- Поиск TODO и обработка их в зависимости от флагов сборки
- Вставка диаграмм (см. выше)
